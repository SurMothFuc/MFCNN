笛卡尔网格在仿真分析中的应用和验证
熊一川，肖周芳*
（杭州电子科技大学 计算机学院, 杭州 310018）
0	前言
数值仿真分析技术已成为工程设计与分析中不可或缺的一项工具，其有助于缩短实际工程中的设计周期和减少研发费用。网格生成是数值仿真分析的关键前处理过程，网格质量的好坏会直接影响数值仿真的精度和效率。常用的网格类型主要有结构网格、非结构网格、嵌套网格、笛卡尔网格和混合网格等几种，各类网格各有优劣。相对于其他类型的网格而言，笛卡尔网格可以在除边界附近区域得到和坐标轴对齐的高质量六面体网格。然而，笛卡尔网格存在一个非常严重的问题，它具有非贴体特性，即边界处的六面体网格点和网格面无法完全落在边界曲面上，使其难以应用于如高雷诺数粘性流动问题的高精度数值计算。为适应模型边界高精度计算需求，单元切割法常被用来获得贴体的笛卡尔网格。这是通过将几何边界切割与边界相交的笛卡尔网格单元来构造的。但随着几何外形的越来越复杂，相交情形复杂多样，又由于浮点精度的不可靠性，往往会遇到各种几何退化的情形，这对于构建拓扑一致的边界单元产生了很大的挑战。
针对以上问题，我们提出了一套完整的基于单元切割的自适应笛卡尔网格生成流程（图1）。借助该流程，我们只需给定几项基本的生成参数便能全自动的生成高质量的笛卡尔网格。在本文中，我们将验证该流程的有效性。
 
图1 基于单元切割的自适应笛卡尔网格生成流程
1	验证方案及平台
为了验证笛卡尔网格生成流程的有效性，我们选用螺旋桨模型、无附体船舶模型、船舶模型、DTMB5415模型和YUPENG模型来测试网格生成速度、网格质量以及算法鲁棒性。同时为了进一步探究生成网格在仿真分析中的应用，我们选用潜水艇模型和燃烧室模型进行数值模拟计算。以上所有测试用例均在个人电脑上运行，硬件配置为处理器AMD R7-5800H，内存16GB。
2	弯管模型
2.1	初始网格
该模型是一个用于模拟气流流动特性的弯管模型，由2,588个三角面片构成。图2(a)为弯管模型的结构图，可以看到它由两个直管段和一个弯曲段组成，图2(b)展示了弯管模型的边界面类型，其中蓝色的面为壁面，灰色的面为流量进口边界条件，红色的面为压力出口边界条件。气流从进口面流入，经过弯曲段时会受到离心力的作用，导致压力分布和速度分布发生变化，最终从出口面流出。
  
(a) 弯管模型物面网格               (b) 弯管模型边界类型
图2 弯管模型
2.2	网格生成
使用笛卡尔网格生成算法得到弯管模型的笛卡尔网格，网格参数设置为在x轴向上平均加密3次，在y轴向上平均加密4次在，z轴向上平均加密6次，在壁面附近进行边界层加密，加密级数为2级，过渡层设为2层。网格数据与时间数据如表1所示，网格单元的总体数量为142,795个，相交处理过程耗时1.0秒，整体流程耗时共2.1秒。图3(a)展示了生成后的笛卡尔网格，图3(b)为弯管的横截面图，可以看出，生成算法只对管壁处进行了加密，而没有对气流进出口面进行加密，这是因为气流在管壁附近流动的计算精度要求会更高，这样做可以提高气流在管壁附近的计算精度。图3(c)和图3(d)分别展示了表面简化前的网格和表面简化后的网格，对比表面简化前后的网格，表面简化前的网格保留了原有模型的网格线，虽然仍可以计算，但会增加计算的复杂度。表面简化后的网格减少了表面网格数量，提高了计算速度。图3(e)为管道弯折处内侧的表面细节图，可以看到表面网格贴合了弯管内侧的弧度，生成的网格质量较好。图3(f)为管道弯折处的网格横截面图，加密层在此处实现了平滑的过渡  
(a) 弯管模型笛卡尔网格                     (b) 弯管网格横截面

   
(c) 未简化表面                            (d) 表面简化后
   
(e) 弯折处内测表面                         (f) 弯折处横截面
图3 弯管模型笛卡尔网格
表1 弯管网格生成时间数据
面片数	网格数量/104	网格自适应
/s	相交处理
/s	构建边界单元/s	总处理时间
/s
	背景网格	最终网格				
2,588	24.6	14.2	0.4	1.0	0.7	2.1
3	方管模型
3.1	初始网格
该模型同样也是一个用于模拟气流流动特性的管道模型，由420个三角面片构成。图4(a)为方管模型的结构图，可以看到它整体是一个方形管道，但在中间有一块扭曲的区域，使得管道呈现出一种扭转的效果。图4(b)展示了方管模型的边界面类型，计算域左侧的蓝色面为流量入口边界条件，右侧红色面为压力出口边界条件，其余面皆为壁面。
3.2	网格生成
使用笛卡尔网格生成算法得到方管模型的笛卡尔网格，网格参数设置为在x轴向上平均加密5次，在y轴向上平均加密4次，在z轴向上平均加密7次，在壁面附近进行边界层加密，加密级数为2级，过渡层设为2层，网格数据和时间数据如表2所示，网格单元的总体数量为629 776个，相交处理过程耗时4.7秒，整体流程耗时共10.3秒。由于我们更关注气流在通道内的流动情况，因此我们保留了管道内的网格。图5(a)展示了生成后的笛卡尔网格，其中可以看出网格在方管管壁内外表面附近有较高的细化程度，以保证物面的准确描述和边界条件的正确施加。同时，网格在方管扭转位置也有较高的细化程度，以捕捉流场中的细节。图5(b)展示了方管的横截面图，其中可以看出网格在方管截面上呈现出规则的矩形结构，与方管截面形状相吻合。图5(c)为方管在Z轴轴向上的横截面图，可以看出网格在方管沿轴向有一定程度的扭转变化，但与方管几何形状相一致。图5(d)为方管在扭转位置的剖切图，从中可见，网格在物面附近形成了两层单元的过渡层，紧贴着扭转的管壁。
      
(a) 方管模型物面网格                      (b) 方管模型边界类型
图4 方管模型
   
(a) 方管模型笛卡尔网格                          (b) 方管网格横截面

   
(c)网格Z轴横截面                           (d) 方管扭转处剖切图
图5 方管模型笛卡尔网格

表2 方管网格生成时间数据
面片数	网格数量/104	网格自适应
/s	相交处理
/s	构建边界单元/s	总处理时间
/s
	背景网格	最终网格				
420	127.6	62.9	2.0	4.7	3.6	10.3
4	船舶模型
4.1	初始网格
该模型是一个船舶模型，由1682个三角面片构成。图6(a)展示了舰艇模型的结构，可以看到该模型的尺度跨度较大，比如有大尺度的船壳板、甲板等部件，也有小尺度的桅杆等部件。图6(b)展示了船舶模型的边界面类型，考虑理想实验，计算域左侧的红色面为流量入口边界条件，右侧蓝色面为压力出口边界条件，其余面皆为壁面。图6(c)为舰艇桅杆区域的细节放大图，可以看到在桅杆部分有一处凹陷的区域，这是一种拓扑复杂的情况。图6(d)展示了位于驾驶台上部的罗经甲板，该结构顶部略有下沉，周围形成了薄型结构。这两处区域对笛卡尔网格生成算法提出了较高的鲁棒性要求。
   
(a) 船舶模型物面网格                       (b) 船舶模型边界类型
   
(c) 船舶桅杆细节                       (d) 船舶罗经甲板细节
图6 船舶模型
4.2	网格生成
用笛卡尔网格生成算法得到船舶模型的笛卡尔网格，网格参数设置为在x轴向上平均加密7次在y轴向和z轴向上平均加密6次，在壁面附近进行边界层加密，加密级数为5级，过渡层设为18层，网格数据和时间数据如表3所示，网格单元的总体数量为7 977 287个，相交处理过程耗时27.7秒，整体流程共耗时66.1秒。图7(a)为船舶网格的整体横截面，图7(b)为近壁处网格横截面图，从中可以看出网格在近壁区域的加密程度和分层结构。
  
(a) 船舶网格整体横截面                    (b) 船舶模型近壁处横截面
图7 船舶模型横截面
表3 船舶网格生成时间数据
面片数	网格数量/104	网格自适应
/s	相交处理
/s	构建边界单元/s	总处理时间
/s
	背景网格	最终网格				
1682	938.7	797.7	16.2	27.7	22.2	66.1
为了直观地展示生成的壁面网格，我们单独提取了生成网格的表面信息，图8(a)展示了船舶桅杆处的表面网格，可以看到经过简化后的表面网格具有较高的质量，能够准确地还原输入几何的形状。为了观察生成的网格在桅杆处的质量和特点，我们对桅杆处网格进行了横截与可视化，图8(b)展示了桅杆处网格的横截面，图8(c)展示了桅杆横截面的后视角图，从中可以看出，网格在桅杆上的覆盖情况较为完整，在桅杆顶部和周边的变化情况也较为合理。图8(d)展示了罗经甲板处的表面网格，从中可以看出网格在拓扑复杂区域的适应性以及光滑性较好，除了少数不满足特征边要求的区域被合并外，其他的小特征区域都被完美的保留了下来。同样为了观察生成的网格在罗经甲板处的质量和特点，我们对罗经甲板处网格进行了横截与可视化。图8(e)为罗经甲板处网格的横截面图，图8(f)为罗经甲板薄型结构处的细节图，我们需要特别关注这两张图中位于输入几何薄型结构位置的笛卡尔单元，这些笛卡尔单元的一部分被薄型区域所截取，这是一种拓扑复杂的情况，生成程序能够有效
